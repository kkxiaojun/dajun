<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基础知识点（一） | KK的知识库</title>
    <meta name="description" content="KK的博客">
    <link rel="icon" href="/dajun/image/avator.png">
    
    <link rel="preload" href="/dajun/assets/css/0.styles.1f0e54bd.css" as="style"><link rel="preload" href="/dajun/assets/js/app.f343371c.js" as="script"><link rel="preload" href="/dajun/assets/js/2.0c3fdcc6.js" as="script"><link rel="preload" href="/dajun/assets/js/21.9596bb56.js" as="script"><link rel="prefetch" href="/dajun/assets/js/10.fb249c9c.js"><link rel="prefetch" href="/dajun/assets/js/11.bcc32090.js"><link rel="prefetch" href="/dajun/assets/js/12.3163a14c.js"><link rel="prefetch" href="/dajun/assets/js/13.02ec6dfa.js"><link rel="prefetch" href="/dajun/assets/js/14.38bb0809.js"><link rel="prefetch" href="/dajun/assets/js/15.0c3815f1.js"><link rel="prefetch" href="/dajun/assets/js/16.e20b17d3.js"><link rel="prefetch" href="/dajun/assets/js/17.d9e6b636.js"><link rel="prefetch" href="/dajun/assets/js/18.1de8ffb4.js"><link rel="prefetch" href="/dajun/assets/js/19.a8065c5a.js"><link rel="prefetch" href="/dajun/assets/js/20.49b7a7fc.js"><link rel="prefetch" href="/dajun/assets/js/22.e0d58b1e.js"><link rel="prefetch" href="/dajun/assets/js/23.395fd466.js"><link rel="prefetch" href="/dajun/assets/js/24.7c3f86b9.js"><link rel="prefetch" href="/dajun/assets/js/25.a851bdef.js"><link rel="prefetch" href="/dajun/assets/js/26.4154af63.js"><link rel="prefetch" href="/dajun/assets/js/27.5c137191.js"><link rel="prefetch" href="/dajun/assets/js/28.39ebcae8.js"><link rel="prefetch" href="/dajun/assets/js/29.153b65ae.js"><link rel="prefetch" href="/dajun/assets/js/3.badd9541.js"><link rel="prefetch" href="/dajun/assets/js/30.edf871b0.js"><link rel="prefetch" href="/dajun/assets/js/31.6ab9ff3c.js"><link rel="prefetch" href="/dajun/assets/js/32.9387a777.js"><link rel="prefetch" href="/dajun/assets/js/33.70b05627.js"><link rel="prefetch" href="/dajun/assets/js/4.94dcadd3.js"><link rel="prefetch" href="/dajun/assets/js/5.caab31e7.js"><link rel="prefetch" href="/dajun/assets/js/6.b93fae90.js"><link rel="prefetch" href="/dajun/assets/js/7.5d572add.js"><link rel="prefetch" href="/dajun/assets/js/8.bfa11565.js"><link rel="prefetch" href="/dajun/assets/js/9.b6aaee89.js">
    <link rel="stylesheet" href="/dajun/assets/css/0.styles.1f0e54bd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/dajun/" class="home-link router-link-active"><img src="/dajun/image/avator.png" alt="KK的知识库" class="logo"> <span class="site-name can-hide">KK的知识库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dajun/" class="nav-link">主页</a></div><div class="nav-item"><a href="/dajun/javascript/" class="nav-link router-link-active">JavaScript基础</a></div><div class="nav-item"><a href="/dajun/broswer/" class="nav-link">浏览器相关</a></div><div class="nav-item"><a href="/dajun/internet/" class="nav-link">网络Http</a></div><div class="nav-item"><a href="/dajun/tcp/" class="nav-link">TCP</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架基础" class="dropdown-title"><span class="title">框架基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dajun/Vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/dajun/React/" class="nav-link">React</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dajun/internet/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/dajun/sort/" class="nav-link">算法</a></li></ul></div></div><div class="nav-item"><a href="https:www.github.com/kkxiaojun" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dajun/" class="nav-link">主页</a></div><div class="nav-item"><a href="/dajun/javascript/" class="nav-link router-link-active">JavaScript基础</a></div><div class="nav-item"><a href="/dajun/broswer/" class="nav-link">浏览器相关</a></div><div class="nav-item"><a href="/dajun/internet/" class="nav-link">网络Http</a></div><div class="nav-item"><a href="/dajun/tcp/" class="nav-link">TCP</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架基础" class="dropdown-title"><span class="title">框架基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dajun/Vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/dajun/React/" class="nav-link">React</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dajun/internet/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/dajun/sort/" class="nav-link">算法</a></li></ul></div></div><div class="nav-item"><a href="https:www.github.com/kkxiaojun" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript基础</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dajun/javascript/base.html" class="active sidebar-link">基础知识点（一）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#基础知识点（一）" class="sidebar-link">基础知识点（一）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#基本类型" class="sidebar-link">基本类型</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#引用类型" class="sidebar-link">引用类型</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#typeof-vs-instanceof" class="sidebar-link">typeof vs instanceof</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#类型转换" class="sidebar-link">类型转换</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#this" class="sidebar-link">this</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#问题总结" class="sidebar-link">问题总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#基础知识点（二）" class="sidebar-link">基础知识点（二）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#vs" class="sidebar-link">== vs ===</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#_0-1-0-2-0-3" class="sidebar-link">0.1 + 0.2  != 0.3</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#闭包" class="sidebar-link">闭包</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#浅拷贝" class="sidebar-link">浅拷贝</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#深拷贝" class="sidebar-link">深拷贝</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#原型" class="sidebar-link">原型</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#new" class="sidebar-link">new</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#继承" class="sidebar-link">继承</a></li></ul></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#进阶模块" class="sidebar-link">进阶模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#模块化" class="sidebar-link">模块化</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#common-js-和-es6-module-区别" class="sidebar-link">Common.js 和 ES6 module 区别</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#tree-shaking" class="sidebar-link">tree shaking</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#rollup与webpack" class="sidebar-link">rollup与webpack</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/base.html#经典题目" class="sidebar-link">经典题目</a></li></ul></li></ul></li><li><a href="/dajun/javascript/es6.html" class="sidebar-link">ES6</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#es6" class="sidebar-link">ES6</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#let与const和块级作用域" class="sidebar-link">let与const和块级作用域</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#字符串的扩展" class="sidebar-link">字符串的扩展</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#数组的扩展" class="sidebar-link">数组的扩展</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#解构赋值" class="sidebar-link">解构赋值</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#函数的扩展" class="sidebar-link">函数的扩展</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#对象的扩展" class="sidebar-link">对象的扩展</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#promise" class="sidebar-link">Promise</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#symbol，set，map" class="sidebar-link">Symbol，Set，Map</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#weakset-weakmap" class="sidebar-link">WeakSet WeakMap</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#class" class="sidebar-link">Class</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/es6.html#总结" class="sidebar-link">总结</a></li></ul></li></ul></li><li><a href="/dajun/javascript/async.html" class="sidebar-link">异步编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#异步编程" class="sidebar-link">异步编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#并发concurrency和并行parallelism" class="sidebar-link">并发concurrency和并行parallelism</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#ajax" class="sidebar-link">ajax</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#callback-hell" class="sidebar-link">callback hell</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#generator" class="sidebar-link">Generator</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#async-及-await" class="sidebar-link">async 及 await</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#promise" class="sidebar-link">Promise</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#常用定时器函数" class="sidebar-link">常用定时器函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#event-loop" class="sidebar-link">Event loop</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#执行栈" class="sidebar-link">执行栈</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#浏览器中的event-loop" class="sidebar-link">浏览器中的Event Loop</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#node中的event-loop" class="sidebar-link">Node中的Event Loop</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#内存泄漏" class="sidebar-link">内存泄漏</a></li></ul></li><li class="sidebar-sub-header"><a href="/dajun/javascript/async.html#js-思考题" class="sidebar-link">JS 思考题</a></li></ul></li><li><a href="/dajun/javascript/sourcecode.html" class="sidebar-link">源码实现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#源码实现" class="sidebar-link">源码实现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#call、aplly、bind-实现" class="sidebar-link">call、aplly、bind 实现</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#new-实现" class="sidebar-link">new 实现</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#class-实现继承" class="sidebar-link">class 实现继承</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#async-await-实现" class="sidebar-link">async/await 实现</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#reduce-实现" class="sidebar-link">reduce 实现</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#实现一个双向数据绑定" class="sidebar-link">实现一个双向数据绑定</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#instanceof-实现" class="sidebar-link">instanceof 实现</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#array-isarray-实现" class="sidebar-link">Array.isArray 实现</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#object-create-的基本实现原理" class="sidebar-link">Object.create 的基本实现原理</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#getownpropertynames-实现" class="sidebar-link">getOwnPropertyNames 实现</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#promise-实现" class="sidebar-link">promise 实现</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#手写一个防抖-节流函数" class="sidebar-link">手写一个防抖/节流函数</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#柯里化函数的实现" class="sidebar-link">柯里化函数的实现</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#手写一个深拷贝" class="sidebar-link">手写一个深拷贝</a></li><li class="sidebar-sub-header"><a href="/dajun/javascript/sourcecode.html#数组中的高阶函数实现" class="sidebar-link">数组中的高阶函数实现</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="基础知识点（一）"><a href="#基础知识点（一）" class="header-anchor">#</a> 基础知识点（一）</h2> <h3 id="基本类型"><a href="#基本类型" class="header-anchor">#</a> 基本类型</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>涉及的内容：基本类型与引用类型有什么不同，null是对象不？</p></div> <p>在JS中，存在6中原始值，分别是：</p> <ul><li><code>boolean</code></li> <li><code>null</code></li> <li><code>undefined</code></li> <li><code>string</code></li> <li><code>number</code></li> <li><code>symbol</code></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>BigInt 是一个内置的对象，它提供了了一种方式来表示所有大于 2^53 的数字，也就是 JavaScript 原始类型 Number 能够能够可靠表示的最大数字。</p></div> <p>解决的问题：在 JavaScript 中，语言所能够保证“安全”（精确）地进行计算的最大整数是 2^53 - 1 ，也就是 9007199254740991 （常量<font color="red"> Number.MAX_SAFE_INTEGER</font>）超过了这个数值，JS 就会产生一些意想不到的问题。BigInt 解决的只是整数计算的精度问题</p> <p>其中 JS 的 <code>number</code> 类型是浮点类型的，在使用中会遇到某些 Bug，比如 <code>0.1 + 0.2 !== 0.3</code>，但是这一块的内容会在进阶部分讲到。<code>string</code> 类型是不可变的，无论你在 <code>string</code> 类型上调用何种方法，都不会对值有改变。</p> <p>另外对于 <code>null</code> 来说，很多人会认为他是个对象类型，其实这是错误的。</p> <p><font color="red">原因： 虽然 <code>typeof null</code> 会输出 object，但是这只是 JS 存在的一个悠久 Bug。在 JS 的最初版本中使用的是 32 位系统，为了性能考虑使用低位存储变量的类型信息，000 开头代表是对象，然而 null 表示为全零，所以将它错误的判断为 object 。虽然现在的内部类型判断代码已经改变了，但是对于这个 Bug 却是一直流传下来。</font></p> <p>其实，根据以下代码也能判断，❌<code>null</code>不是对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">null</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span>
<span class="token comment">// false</span>
</code></pre></div><p><strong>基本类型是按值访问的。</strong></p> <ul><li>基本类型的值是不可变的。（具体的理解就是，如果重新赋值，会开辟新的栈内存）</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;123hello321&quot;</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 123HELLO321</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 123hello321</span>
</code></pre></div><ul><li>变量是存储在Stack中的。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token string">&quot;zyj&quot;</span><span class="token punctuation">;</span>
b <span class="token operator">=</span> a<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// zyj</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// zyj</span>
a <span class="token operator">=</span> <span class="token string">&quot;呵呵&quot;</span><span class="token punctuation">;</span>       <span class="token comment">// 改变 a 的值，并不影响 b 的值</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 呵呵</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// zyj</span>
</code></pre></div><p>图解如下：栈内存中包括了变量的标识符和变量的值</p> <img src="/dajun/image/javascript/js-heap.png" alt="foo"> <h3 id="引用类型"><a href="#引用类型" class="header-anchor">#</a> 引用类型</h3> <p>除过上面的 6 种基本数据类型外，剩下的就是引用类型了，统称为 <code>Object 类型</code>。细分的话，有：<code>Object 类型</code>、<code>Array 类型</code>、<code>Date 类型</code>、<code>RegExp 类型</code>、<code>Function 类型</code> 等。</p> <p><strong>引用类型的值是按引用访问的。</strong></p> <ul><li>引用类型的值是可变的。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">&quot;zyj&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>   <span class="token comment">// 创建一个对象</span>
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;percy&quot;</span><span class="token punctuation">;</span>       <span class="token comment">// 改变 name 属性的值</span>
obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">;</span>             <span class="token comment">// 添加 age 属性</span>
obj<span class="token punctuation">.</span><span class="token function-variable function">giveMeAll</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot; : &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>                        <span class="token comment">// 添加 giveMeAll 方法</span>
obj<span class="token punctuation">.</span><span class="token function">giveMeAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>引用类型的比较是引用的比较。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">// 新建一个空对象 obj1</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment">// 新建一个空对象 obj2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1 <span class="token operator">==</span> obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1 <span class="token operator">===</span> obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// false</span>
</code></pre></div><p>因为 obj1 和 obj2 分别引用的是存放在堆内存中的2个不同的对象，故变量 obj1 和 obj2 的值（引用地址）也是不一样的！</p> <ul><li>引用类型的值是保存在堆内存（Heap）中的对象（Object）
与其他编程语言不同，JavaScript 不能直接操作对象的内存空间（堆内存）。</li></ul> <p>图解如下：</p> <ul><li>栈内存中保存了变量标识符和指向堆内存中该对象的指针</li> <li>堆内存中保存了对象的内容</li></ul> <img src="/dajun/image/javascript/js-stack.png" alt="foo"> <h3 id="typeof-vs-instanceof"><a href="#typeof-vs-instanceof" class="header-anchor">#</a> typeof vs instanceof</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>typeof 是否能正确判断类型？instanceof 能正确判断对象的原理是什么？</p></div> <p><code>typeof</code>。只能识别值类型和函数，不能识别引用类型。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">typeof</span> <span class="token keyword">undefined</span> <span class="token comment">// undefined</span>

<span class="token keyword">typeof</span> <span class="token number">123</span> <span class="token comment">// number</span>

<span class="token keyword">typeof</span> <span class="token string">'rty'</span> <span class="token comment">// string</span>

<span class="token keyword">typeof</span> <span class="token boolean">true</span> <span class="token comment">// boolean</span>

<span class="token keyword">typeof</span> <span class="token keyword">null</span> <span class="token comment">// object</span>

<span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// object</span>

<span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// object</span>

<span class="token keyword">typeof</span> console<span class="token punctuation">.</span>log <span class="token comment">// function</span>
</code></pre></div><p><code>typeof</code> 对于对象来说，除了函数都会显示 <code>object</code>，所以说 <code>typeof</code> 并不能准确判断变量到底是什么类型。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 'object'</span>
<span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 'object'</span>
</code></pre></div><p>判断一个对象的正确类型，可以使用 <code>instanceof</code>，因为内部机制是通过原型链来判断的，在后面的章节中我们也会自己去实现一个 <code>instanceof</code>。</p> <blockquote><p>instanceof, 用来判断某个构造函数的 prototype 属性所指向的对象是否存在于另外一个要检测对象的原型链上</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
p1 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span> <span class="token comment">// true</span>

<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'hello world'</span>
str <span class="token keyword">instanceof</span> <span class="token class-name">String</span> <span class="token comment">// false</span>

<span class="token keyword">var</span> str1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
str1 <span class="token keyword">instanceof</span> <span class="token class-name">String</span> <span class="token comment">// true</span>
</code></pre></div><p>对于基本类型来说，你想直接通过 <code>instanceof</code> 来判断类型是不行的。</p> <h3 id="类型转换"><a href="#类型转换" class="header-anchor">#</a> 类型转换</h3> <p>首先我们要知道，在 JS 中类型转换只有三种情况，分别是：</p> <ul><li>转换为<code>Boolean</code></li> <li>转换为<code>Number</code></li> <li>转换为string</li></ul> <p>转换表格</p> <img src="/dajun/image/javascript/translate.webp" alt="foo"> <h4 id="转boolean"><a href="#转boolean" class="header-anchor">#</a> 转Boolean</h4> <p>在条件判断时，除了 <code>undefined</code>， <code>null</code>， <code>false</code>， <code>NaN</code>， <code>''</code>， <code>0</code>， <code>-0</code>，其他所有值都转为 <code>true</code>，包括所有对象。</p> <h4 id="对象转基本类型"><a href="#对象转基本类型" class="header-anchor">#</a> 对象转基本类型</h4> <p>对象在转换类型的时候，会调用内置的 <code>[[ToPrimitive]]</code> 函数，对于该函数来说，算法逻辑一般来说如下：</p> <ul><li>如果已经是原始类型了，那就不需要转换了</li> <li>调用 <code>x.valueOf()</code>，如果转换为基础类型，就返回转换的值</li> <li>调用 <code>x.toString()</code>，如果转换为基础类型，就返回转换的值</li> <li>如果都没有返回原始类型，就会报错</li></ul> <p>当然你也可以重写 <code>Symbol.toPrimitive</code> ，该方法在转原始类型时调用优先级最高。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'1'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token number">1</span> <span class="token operator">+</span> a <span class="token comment">// =&gt; 3</span>
</code></pre></div><h4 id="四则运算"><a href="#四则运算" class="header-anchor">#</a> 四则运算</h4> <p><strong>加法运算符</strong>不同于其他几个运算符，它有以下几个特点：</p> <ul><li>运算中其中一方为字符串，那么就会把另一方也转换为字符串。</li> <li>如果一方不是字符串或者数字，那么会将它转换为数字或者字符串。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">1</span> <span class="token operator">+</span> <span class="token string">'1'</span> <span class="token comment">// '11'</span>
<span class="token boolean">true</span> <span class="token operator">+</span> <span class="token boolean">true</span> <span class="token comment">// 2</span>
<span class="token number">4</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">// &quot;41,2,3&quot;  [1,2,3].toString() =&gt; 1,2,3</span>
</code></pre></div><p>另外对于加法还需要注意这个表达式 <code>'a' + + 'b'</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'a'</span> <span class="token operator">+</span> <span class="token operator">+</span> <span class="token string">'b'</span> <span class="token comment">// -&gt; &quot;aNaN&quot;</span>
</code></pre></div><p>因为 <code>+ 'b'</code> 等于 <code>NaN</code>，所以结果为 <code>&quot;aNaN&quot;</code>，你可能也会在一些代码中看到过 <code>+ '1'</code> 的形式来快速获取 <code>number</code> 类型。</p> <p>那么对于<strong>除了加法的运算符</strong>来说，只要其中一方是数字，那么另一方就会被转为数字</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">4</span> <span class="token operator">*</span> <span class="token string">'3'</span> <span class="token comment">// 12</span>
<span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 0</span>
<span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment">// NaN</span>
</code></pre></div><blockquote><p>全局属性 <strong>NaN</strong> 的值表示不是一个数字（Not-A-Number）。</p></blockquote> <h4 id="比较运算符"><a href="#比较运算符" class="header-anchor">#</a> 比较运算符</h4> <ol><li>如果是对象，就通过 <code>toPrimitive</code> 转换对象</li> <li>如果是字符串，就通过 <code>unicode</code> 字符索引来比较</li></ol> <div class="language- extra-class"><pre class="language-text"><code>let a = {
  valueOf() {
    return 0
  },
  toString() {
    return '1'
  }
}
a &gt; -1 // true
</code></pre></div><p>在以上代码中，因为 <code>a</code> 是对象，所以会通过 <code>valueOf</code> 转换为原始类型再比较值。</p> <h4 id="逻辑运算符"><a href="#逻辑运算符" class="header-anchor">#</a> 逻辑运算符</h4> <ul><li><p>&amp;&amp;：第一个值为false则输出第一个值，否则输出第二个值</p></li> <li><p>||：第一个值为true则输出第一个值，否则输出第二个值</p></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> <span class="token number">4</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//当结果为真时，返回第二个为真的值4 </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token number">4</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//当结果为假时，返回第一个为假的值0 </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token number">5</span> <span class="token operator">||</span> <span class="token number">4</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//当结果为真时，返回第一个为真的值5 </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//当结果为假时，返回第二个为假的值0</span>
</code></pre></div><h3 id="this"><a href="#this" class="header-anchor">#</a> this</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>如何正确判断 this？箭头函数的 this 是什么？</p></div> <p><code>this</code>是很容易混淆的，我们先来看看几个函数的调用场景</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  foo<span class="token punctuation">:</span> foo
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>'箭头函数<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>接下来一个个分析上面的几个场景：</strong></p> <ol><li>直接<code>foo</code>调用，函数的<code>this</code>就是<code>window</code>，（注意：<code>use strict</code>下是<code>undefined</code>）。</li> <li>对于<code>obj.foo()</code>，只要记住谁调用了函数，谁就是<code>this</code>。所以这个场景下，函数中的<code>this</code>就是<code>obj</code>。(延伸：o.obj.foo(), 看foo的上下文)</li> <li>对于<code>new</code>，<code>this</code>肯定是绑定在<code>c</code>上，不会变。</li> <li>箭头函数。不绑定<code>this</code>。另外对箭头函数使用 <code>bind</code> 这类函数是无效的。</li></ol> <p><strong>最后是bind、apply等改变上下文的API</strong>，<code>this</code>永远由第一次<code>bind</code>决定</p> <p>但是可能会发生多个规则同时出现的情况，这时候不同的规则之间会根据优先级最高的来决定 <code>this</code> 最终指向哪里</p> <p>优先级：</p> <ol><li><code>new</code></li> <li><code>bind</code>等</li> <li><code>obj.foo</code></li> <li><code>foo</code>调用</li></ol> <p>ps: <font color="red">匿名函数this指向window</font></p> <h3 id="问题总结"><a href="#问题总结" class="header-anchor">#</a> 问题总结</h3> <ol><li>null是对象吗？</li></ol> <p>虽然 <code>typeof null</code> 会输出 object，但是这只是 JS 存在的一个悠久 Bug。在 JS 的最初版本中使用的是 32 位系统，为了性能考虑使用低位存储变量的类型信息，000 开头代表是对象，然而 null 表示为全零，所以将它错误的判断为 object 。虽然现在的内部类型判断代码已经改变了，但是对于这个 Bug 却是一直流传下来。</p> <p><code>null instanceof Object</code>为<code>false</code>也能证明<code>null</code>不是对象。</p> <ol start="2"><li><p>基本类型与引用类型有什么不同？</p> <ol><li><p>基本类型存储的是值，引用类型存储的是地址（指针）。</p></li> <li><p>基本类型的值是不可变的（重新赋值会开辟新的内存空间），引用类型的值是可变的。</p></li> <li><p>值类型。<font color="red">栈内存</font>(栈是为执行线程留出的内存空间,栈附属于线程，因此当线程结束时栈被回收)</p></li> <li><p>引用类型(对象、数组、函数)。<font color="red">堆内存</font>（堆（heap）是为动态分配预留的内存空间,堆通常通过运行时在应用程序启动时被分配，当应用程序（进程）退出时被回收）。</p></li></ol></li> <li><p><code>this</code>的几种调用方式。</p> <ol><li>直接<code>foo</code>调用，函数的<code>this</code>就是<code>window</code>。</li> <li>对于<code>obj.foo()</code>，只要记住谁调用了函数，谁就是<code>this</code>。所以这个场景下，函数中的<code>this</code>就是<code>obj</code>。</li> <li>对于<code>new</code>，<code>this</code>肯定是绑定在<code>c</code>上，不会变。</li> <li>箭头函数。不绑定<code>this</code>。另外对箭头函数使用 <code>bind</code> 这类函数是无效的。</li> <li><code>bind、apply、call</code>。<code>this</code>永远由第一次<code>bind</code>决定。</li></ol></li></ol> <h2 id="基础知识点（二）"><a href="#基础知识点（二）" class="header-anchor">#</a> 基础知识点（二）</h2> <h3 id="vs"><a href="#vs" class="header-anchor">#</a> == vs ===</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>用法：何时使用==和===？除了（obj.a == null ,jquery源码写法）其它均用===</p></div> <p>解析：</p> <ol><li>对于 === 来说，就是判断两者类型和值是否相同。</li> <li>对于==，只判断值是否相同。</li></ol> <h3 id="_0-1-0-2-0-3"><a href="#_0-1-0-2-0-3" class="header-anchor">#</a> 0.1 + 0.2  != 0.3</h3> <p>先说原因，因为 JS 采用 IEEE 754 双精度版本（64位），并且只要采用 IEEE 754 的语言都有该问题。</p> <p>我们都知道计算机是通过二进制来存储东西的，那么 <code>0.1</code> 在二进制中会表示为</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// (0011) 表示循环</span>
<span class="token number">0.1</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">^</span><span class="token operator">-</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">1.10011</span><span class="token punctuation">(</span><span class="token number">0011</span><span class="token punctuation">)</span>
</code></pre></div><p>我们可以发现，<code>0.1</code> 在二进制中是无限循环的一些数字，其实不只是 <code>0.1</code>，其实很多十进制小数用二进制表示都是无限循环的。这样其实没什么问题，<font color="red">但是 JS 采用的浮点数标准却会裁剪掉我们的数字。</font></p> <p>IEEE 754 双精度版本（64位）将 64 位分为了三段</p> <ul><li>第一位用来表示符号</li> <li>接下去的 11 位用来表示指数</li> <li>其他的位数用来表示有效位，也就是用二进制表示 <code>0.1</code> 中的 <code>10011(0011)</code></li></ul> <p>那么这些循环的数字被裁剪了，就会出现精度丢失的问题，也就造成了 <code>0.1</code> 不再是 <code>0.1</code> 了，而是变成了 <code>0.100000000000000002</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">0.100000000000000002</span> <span class="token operator">===</span> <span class="token number">0.1</span> <span class="token comment">// true</span>
</code></pre></div><p>那么同样的，<code>0.2</code> 在二进制也是无限循环的，被裁剪后也失去了精度变成了 <code>0.200000000000000002</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">===</span> <span class="token number">0.30000000000000004</span> <span class="token comment">// true</span>
</code></pre></div><p>那么说完了为什么，最后来说说怎么解决这个问题吧。其实解决的办法有很多，这里我们选用原生提供的方式来最简单的解决问题</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0.3</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="闭包"><a href="#闭包" class="header-anchor">#</a> 闭包</h3> <p><strong>定义和理解</strong></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>函数A内部有一个函数B，函数B能访问函数A的变量，函数B就是闭包</p></div> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'result:'</span><span class="token punctuation">,</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在JS中闭包的意义就是让我们可以间接访问函数内部的变量。</p> <p>:::
<strong>经典题目</strong>
:::</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p><code>setTimeout</code> 是个异步函数，所以会先把循环全部执行完毕，这时候 i 就是 6 了，所以会输出一堆 6。</p> <p><strong>解决方法</strong></p> <ol><li>采用闭包</li> <li>使用<code>setTimeout</code>的第3个参数</li> <li>用<code>let</code>（推荐）</li></ol> <p>方法一： 使用闭包</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> j <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>方法二： 使用<code>setTimeout</code>的第3个参数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>方法三： <code>let</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="浅拷贝"><a href="#浅拷贝" class="header-anchor">#</a> 浅拷贝</h3> <ol><li><code>Object.assign()</code></li> <li>展开运算符<code>...</code></li></ol> <p><code>Object.assign()</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'hualala'</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
  a<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'hualala-go'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// hualala</span>
</code></pre></div><p>展开运算符<code>...</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'hualala'</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>a<span class="token punctuation">}</span>
  a<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'hualala-go'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// hualala</span>
</code></pre></div><p>浅拷贝的问题： 对象里边存在对象，拷贝出问题</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  age<span class="token punctuation">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
  jobs<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    first<span class="token punctuation">:</span> <span class="token string">'huahua'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>a <span class="token punctuation">}</span>
a<span class="token punctuation">.</span>jobs<span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token string">'native'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>jobs<span class="token punctuation">.</span>first<span class="token punctuation">)</span> <span class="token comment">// native</span>
</code></pre></div><p>这时需要深拷贝的配合</p> <h3 id="深拷贝"><a href="#深拷贝" class="header-anchor">#</a> 深拷贝</h3> <ol><li><code>JSON.parse(JSON.stringfy(obj))</code></li></ol> <p>但是该方法也是有局限性的：</p> <ul><li>会忽略 undefined</li> <li>会忽略 symbol</li> <li>不能序列化函数</li> <li>不能解决循环引用的对象</li></ul> <p>当然你可能想自己来实现一个深拷贝，但是其实实现一个深拷贝是很困难的，需要我们考虑好多种边界情况，
比如原型链如何处理、DOM 如何处理等等, 推荐使用<code>lodash</code></p> <h3 id="原型"><a href="#原型" class="header-anchor">#</a> 原型</h3> <p>输入</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> obj <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><img src="/dajun/image/javascript/prototype1.png" alt="foo"> <p>会发现每个 JS 对象都有 <code>__proto__</code> 属性，这个属性指向了原型。这个属性在现在来说已经不推荐直接去使用它了，这只是浏览器在早期为了让我们访问到内部属性 [[prototype]] 来实现的一个东西。</p> <p><code>constructor</code>里边有个<code>prototype</code>属性，这个属性对应的值和先前我们在<code>__proto__</code>中的一样。</p> <p>结论：
原型的<code>constructor</code>属性指向构造函数，构造函数通过<code>prototype</code>属性指回原型。</p> <img src="/dajun/image/javascript/prototype.png" alt="foo"> <h3 id="new"><a href="#new" class="header-anchor">#</a> new</h3> <p><strong>描述new一个对象的例子</strong></p> <ol><li>创建一个空的简单JavaScript对象（即<code>{}</code>）。</li> <li>链接该对象（即设置该对象的构造函数）到另一个对象。</li> <li>将步骤1新创建的对象作为this的上下文。</li> <li>如果该函数没有返回对象，则返回this。</li></ol> <p>注意：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token string">&quot;Lucas&quot;</span>
    <span class="token keyword">const</span> o <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> o
<span class="token punctuation">}</span>
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
</code></pre></div><p><code>undefined</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token string">&quot;Lucas&quot;</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
</code></pre></div><p><code>Lucas</code></p> <blockquote><p>结论：如果构造函数中显式返回一个值，且返回的是一个对象，那么 this 就指向这个返回的对象；如果返回的不是一个对象，那么 this 仍然指向实例。</p></blockquote> <p>详解</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">myNew</span><span class="token punctuation">(</span><span class="token parameter">_constructor<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 第一步 1</span>
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// 第二步 2</span>
  obj<span class="token punctuation">.</span>_proto_ <span class="token operator">=</span> <span class="token class-name">_constructor</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
  <span class="token comment">//把该对象的原型指向构造函数的原型对象，就建立起原型了：obj-&gt;Animal.prototype-&gt;Object.prototype-&gt;null</span>
  <span class="token keyword">return</span> <span class="token function">_constructor</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h3> <p>在JS中，<code>class</code>只是语法糖并不存在类</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Car <span class="token keyword">instanceof</span> <span class="token class-name">Function</span> <span class="token comment">// true</span>
</code></pre></div><h4 id="原型链"><a href="#原型链" class="header-anchor">#</a> 原型链</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>parentName <span class="token operator">=</span> <span class="token string">'kk'</span>
<span class="token punctuation">}</span>

<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>parentName
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>问题</strong></p> <p>引用类型的属性被所有实例共享：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'kk'</span><span class="token punctuation">,</span> <span class="token string">'oo'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

child1<span class="token punctuation">.</span>names<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'11'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;kk&quot;, &quot;oo&quot;, &quot;11&quot;]</span>

<span class="token keyword">var</span> child2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2<span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;kk&quot;, &quot;oo&quot;, &quot;11&quot;]</span>
</code></pre></div><h4 id="借用构造函数-经典继承"><a href="#借用构造函数-经典继承" class="header-anchor">#</a> 借用构造函数(经典继承)</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'kevin'</span><span class="token punctuation">,</span> <span class="token string">'daisy'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// call 方式绑定this，由第一次绑定决定</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

child1<span class="token punctuation">.</span>names<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yayu'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;kevin&quot;, &quot;daisy&quot;, &quot;yayu&quot;]</span>

<span class="token keyword">var</span> child2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2<span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;kevin&quot;, &quot;daisy&quot;]</span>
</code></pre></div><p>优点：</p> <p>1.避免了引用类型的属性被所有实例共享</p> <p>2.可以在 Child 中向 Parent 传参</p> <p>例子：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'kevin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// kevin</span>

<span class="token keyword">var</span> child2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'daisy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// daisy</span>
</code></pre></div><p>缺点：</p> <p>方法都在构造函数中定义，每次创建实例都会创建一遍方法。</p> <h4 id="组合继承（原型链和构造函数）"><a href="#组合继承（原型链和构造函数）" class="header-anchor">#</a> 组合继承（原型链和构造函数）</h4> <p>原型链继承和经典继承双剑合璧。</p> <p>使用原型链实现对<strong>原型属性和方法</strong>的继承，而通过借用构造函数来实现对<strong>实例属性</strong>的继承</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value
<span class="token punctuation">}</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getValue</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
child<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
child <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span> <span class="token comment">// true</span>
</code></pre></div><p>组合继承的方式核心是在子类的构造函数中通过 <code>Parent.call(this)</code> 继承父类的属性，然后改变子类的原型为 <code>new Parent()</code> 来继承父类的函数。</p> <p>优点：</p> <p>这种继承方式优点在于构造函数可以传参，不会与父类引用属性共享，可以复用父类的函数</p> <p>缺点：</p> <p>在继承父类函数的时候调用了父类构造函数，导致子类的原型上多了不需要的父类属性，存在内存上的浪费。</p> <h4 id="原型式继承"><a href="#原型式继承" class="header-anchor">#</a> 原型式继承</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createObj</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ES5 Object.create 的模拟实现，将传入的对象作为创建的对象的原型。</p> <p>缺点：</p> <p>包含引用类型的属性值始终都会共享相应的值，这点跟原型链继承一样。</p> <h4 id="寄生式继承"><a href="#寄生式继承" class="header-anchor">#</a> 寄生式继承</h4> <p>创建一个仅用于封装继承过程的函数，该函数在内部以某种形式来做<strong>增强对象</strong>，最后返回对象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createObj</span> <span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> clone <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
    clone<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>缺点：跟借用构造函数模式一样，每次创建对象都会创建一遍方法。</p> <h4 id="寄生组合式继承"><a href="#寄生组合式继承" class="header-anchor">#</a> 寄生组合式继承</h4> <p>这种继承方式对组合继承进行了优化，组合继承缺点在于继承父类函数时调用两次构造函数</p> <p>组合继承：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 第二次调用构造函数</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 第一次调用构造函数</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'kevin'</span><span class="token punctuation">,</span> <span class="token string">'18'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">)</span>
</code></pre></div><p>我们只需要优化掉这点就行了。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 关键的三步</span>
<span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'kevin'</span><span class="token punctuation">,</span> <span class="token string">'18'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>优化：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">prototype</span><span class="token punctuation">(</span><span class="token parameter">child<span class="token punctuation">,</span> parent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> prototype <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
    prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> child<span class="token punctuation">;</span>
    child<span class="token punctuation">.</span>prototype <span class="token operator">=</span> prototype<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 当我们使用的时候：</span>
<span class="token function">prototype</span><span class="token punctuation">(</span>Child<span class="token punctuation">,</span> Parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用<code>Object.create()</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  constructor<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> Child<span class="token punctuation">,</span>
    enumerable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    writable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    configurable<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="class继承"><a href="#class继承" class="header-anchor">#</a> Class继承</h4> <p>在 ES6 中，我们可以使用 <code>class</code> 去实现继承，并且实现起来很简单</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value
  <span class="token punctuation">}</span>
  <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
child<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
child <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span> <span class="token comment">// true</span>
</code></pre></div><p><code>class</code> 实现继承的核心在于使用 <code>extends</code> 表明继承自哪个父类，并且在子类构造函数中必须调用 <code>super</code>，因为这段代码可以看成 <code>Parent.call(this, value)</code>。</p> <p>当然了，之前也说了在 JS 中并不存在类，<code>class</code> 的本质就是函数。</p> <h2 id="进阶模块"><a href="#进阶模块" class="header-anchor">#</a> 进阶模块</h2> <h3 id="模块化"><a href="#模块化" class="header-anchor">#</a> 模块化</h3> <p>使用一个技术肯定是有原因的，那么使用模块化可以给我们带来以下好处</p> <ul><li>解决命名冲突</li> <li>提供复用性</li> <li>提高代码可维护性</li></ul> <p><strong>立即执行函数</strong>
在早期，使用立即执行函数实现模块化是常见的手段，通过函数作用域解决了命名冲突、污染全局作用域的问题</p> <p><strong>AMD 和 CMD</strong></p> <ol><li>对于依赖的模块，AMD 是提前执行，CMD 是延迟执行.不过 RequireJS 从 2.0 开始，也改成可以延迟执行（根据写法不同，处理方式不同）。</li> <li>CMD 推崇依赖就近，AMD 推崇依赖前置</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// AMD</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./a'</span><span class="token punctuation">,</span> <span class="token string">'./b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 加载模块完毕可以使用</span>
  a<span class="token punctuation">.</span><span class="token function">do</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  b<span class="token punctuation">.</span><span class="token function">do</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// CMD</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 加载模块</span>
  <span class="token comment">// 可以把 require 写在函数体的任意地方实现延迟加载</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a'</span><span class="token punctuation">)</span>
  a<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>COMMONJS</strong>
CommonJS 最早是 Node 在使用，目前也仍然广泛使用，比如在 Webpack 中你就能见到它，当然目前在 Node 中的模块管理已经和 CommonJS 有一些区别了。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// a.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token comment">// or</span>
exports<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>a <span class="token comment">// a</span>
</code></pre></div><p><strong>require</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// a.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token comment">// or</span>
exports<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token comment">// 这里其实是包裹了一层立即执行函数，避免污染全局作用域</span>
<span class="token comment">// 重要的是module,module是NODE的独有的一个变量</span>

<span class="token comment">// module的基本实现</span>
<span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 唯一标识，require引入的时候需要知道的</span>
  exports<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 空对象</span>
<span class="token punctuation">}</span>

<span class="token comment">// module和module.exports用法相同的原因</span>
<span class="token keyword">var</span> exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports
<span class="token keyword">var</span> <span class="token function-variable function">load</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">load</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 需要导出的内容</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> a
  <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports
<span class="token punctuation">}</span>

</code></pre></div><p>注意：<code>exports</code> 和 <code>module.exports</code> 用法相似，但是不能对 <code>exports</code> 直接赋值。因为<code>exports</code>和<code>module.exports</code>拥有同一块内存地址，直接对<code>exports</code>赋值，将导致两者指向不同的内存地址，导致后续不同步。</p> <p><strong>ES Module</strong>
ES6 模块的设计思想，是尽量的<strong>静态化</strong>，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。CommonJS 和 AMD 模块，都只能在运行时确定这些东西。比如，CommonJS 模块就是对象，输入时必须查找对象属性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span>

<span class="token comment">// 等同于</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> obj<span class="token punctuation">.</span>a<span class="token punctuation">,</span> b <span class="token operator">=</span> obj<span class="token punctuation">.</span>b<span class="token punctuation">,</span> c <span class="token operator">=</span> obj<span class="token punctuation">.</span>c<span class="token punctuation">;</span>
</code></pre></div><p>上面代码的实质是整体加载a模块（即加载a.js的所有方法），生成一个对象（obj），然后再从这个对象上面读取3个方法。这种加载称为“运行时加载”，因为只有运行时才能得到这个对象，导致完全没办法在编译时做“静态优化”。</p> <p>ES6 模块不是对象，而是通过<code>export</code>命令显式指定输出的代码，再通过import命令输入。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="common-js-和-es6-module-区别"><a href="#common-js-和-es6-module-区别" class="header-anchor">#</a> Common.js 和 ES6 module 区别</h3> <ol><li>commonJs 是被加载的时候运行(运行时加载)，ES6 Module 是编译的时候运行（编译时加载（好处：可做Tree-shaking优化））</li> <li>commonJs 输出的是<strong>值的浅拷贝</strong>，<strong>ES6 Module 输出值的引用</strong></li> <li>webpack 中的 <code>__webpack_require__</code> 对他们处理方式不同(common.js：实现exports和require，es6 module：通过实现自己的<code>__webpack_require</code>和<code>__webpack_exports__</code>装换成类似common.js的形式, 混用时，用<code>__webpack_require__n</code>)</li> <li>webpack 的按需加载实现（Webpack支持定义分割点<code>Code Splitting</code>, 通过require.ensure进行按需加载）</li></ol> <h3 id="tree-shaking"><a href="#tree-shaking" class="header-anchor">#</a> tree shaking</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>移除 JavaScript 上下文中的未引用代码</p></div> <ol><li>虽然<code>production</code>模式下默认开启，但是由于经过 babel 编译全部模块被封装成 IIFE(立即执行函数)</li> <li>IIFE 存在副作用（主要是babel的锅）可能无法被 tree-shaking</li> <li>需要设置<code>package.json</code> 的 <code>sideEffects</code></li></ol> <h3 id="rollup与webpack"><a href="#rollup与webpack" class="header-anchor">#</a> rollup与webpack</h3> <p>rollup</p> <ol><li>它支持<strong>导出ES模块的包</strong>。</li> <li>它支持<strong>程序流分析</strong>，能更加正确的判断项目本身的代码是否有副作用。</li></ol> <p>webpack</p> <ol><li>适合应用程序</li></ol> <h3 id="经典题目"><a href="#经典题目" class="header-anchor">#</a> 经典题目</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>此题涉及的知识点众多，包括变量定义提升、this指针指向、运算符优先级、原型、继承、全局变量污染、对象属性及原型属性优先级等等。</p></div> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Foo<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

<span class="token comment">//请写出以下输出结果：</span>
Foo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Foo<span class="token punctuation">.</span>getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">new</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>第一问</strong>
先看此题的上半部分做了什么，首先定义了一个叫Foo的函数，之后为Foo创建了一个叫getName的静态属性存储了一个匿名函数，之后为Foo的原型对象新创建了一个叫getName的匿名函数。之后又通过函数变量表达式创建了一个getName的函数，最后再声明一个叫getName函数。</p> <p>第一问的 Foo.getName 自然是访问Foo函数上存储的静态属性，自然是2，没什么可说的。</p> <p><strong>第二问</strong>
第二问，直接调用 getName 函数。既然是直接调用那么就是访问当前上文作用域内的叫getName的函数，所以跟1 2 3都没什么关系。此题有无数面试者回答为5。此处有两个坑，一是变量声明提升，二是函数表达式。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>变量声明提升,即所有声明变量或声明函数都会被提升到当前函数的顶部。</p></div> <p>函数声明被对象字面量覆盖</p> <p>最终输出4</p> <p><strong>第三问</strong>
简单的讲，this的指向是由所在函数的调用方式决定的。而此处的直接调用方式，this指向window对象。</p> <p>遂Foo函数返回的是window对象，相当于执行 window.getName() ，而window中的getName已经被修改为alert(1)，所以最终会输出1</p> <p><strong>第四问</strong>
直接调用getName函数，相当于 window.getName() ，因为这个变量已经被Foo函数执行时修改了，遂结果与第三问相同，为1</p> <p><strong>第五问</strong></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>() &gt; . &gt; new</p></div> <p>此处考察的是js的运算符优先级问题</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token punctuation">(</span>Foo<span class="token punctuation">.</span>getName<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>弹出2</p> <p><strong>第六问</strong></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>在传统语言中，构造函数不应该有返回值，实际执行的返回值就是此构造函数的<strong>实例化对象</strong>。</p></div> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>输出3</p> <p><strong>第七问</strong>
最终结果为3</p> <p>实际上这里成员访问的优先级是最高的，因此先执行了 .getName，但是在进行左侧取值的时候， new Foo() 可以理解为两种运算：new 带参数（即 new Foo()）和函数调用（即 先 Foo() 取值之后再 new），而 new 带参数的优先级是高于函数调用的，因此先执行了 new Foo()，或得 Foo 类的实例对象，再进行了成员访问 .getName。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/17/2020, 11:51:39 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/dajun/javascript/es6.html">ES6</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/dajun/assets/js/app.f343371c.js" defer></script><script src="/dajun/assets/js/2.0c3fdcc6.js" defer></script><script src="/dajun/assets/js/21.9596bb56.js" defer></script>
  </body>
</html>
